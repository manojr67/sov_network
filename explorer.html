<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LATTICE EXPLORER | Sovereign Mesh Intelligence</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;500;700;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
    <style>
        :root { --primary: #ff8c00; --bg: #f8fafc; --card: #ffffff; --text: #1a1c1e; --muted: #64748b; --border: #e2e8f0; --success: #10b981; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); padding: 2rem; overflow-x: hidden; }
        .grid-layout { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
        .card { padding: 1.5rem; border-radius: 24px; border: 1px solid var(--border); background: var(--card); box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        #live-stream-container { height: 400px; overflow-y: auto; background: #fafafa; border-radius: 20px; padding: 20px; font-family: 'Fira Code'; font-size: 11px; border: 1px solid var(--border); margin-top: 15px; }
        .stream-entry { margin-bottom: 10px; border-left: 3px solid var(--primary); padding-left: 12px; }
        .sov-table { width: 100%; border-collapse: collapse; margin-top: 1rem; font-size: 11px; }
        .sov-table th { text-align: left; padding: 12px; color: var(--muted); border-bottom: 2px solid var(--border); }
        .sov-table td { padding: 12px; border-bottom: 1px solid var(--border); }
    </style>
</head>
<body>
    <div style="display:flex; justify-content:space-between; margin-bottom:2rem;">
        <h2>LATTICE EXPLORER <small style="font-size:10px; color:var(--muted);">v165.0 SECURE</small></h2>
        <div id="net-status" style="font-size:10px; font-weight:800; color:var(--success);">MESH LIVE: CONNECTED</div>
    </div>
    <div class="grid-layout">
        <div class="card" style="grid-column: span 2;">
            <h4>Live Encrypted Shard Stream</h4>
            <div id="live-stream-container">Syncing Handshakes...</div>
        </div>
        <div class="card">
            <h4>Mesh Telemetry</h4>
            <div style="margin-top:20px;">Latency: <b style="color:var(--success);">0.4ms</b><br>Encryption: <b>AES-256</b><br>Peers: <b id="peer-count">...</b></div>
        </div>
    </div>
    <div class="card" style="margin-top:20px;">
        <h4>Decentralized Shard Ledger</h4>
        <table class="sov-table">
            <thead><tr><th>Hash</th><th>Origin</th><th>Action</th><th>Status</th></tr></thead>
            <tbody id="ledger-list"></tbody>
        </table>
    </div>

<script>
    const CipherShield = {
        MESH_SECRET: "SOV_LATTICE_INTEGRITY_SHIELD_99",
        decrypt(cipher) {
            try { return JSON.parse(CryptoJS.AES.decrypt(cipher, this.MESH_SECRET).toString(CryptoJS.enc.Utf8)); }
            catch(e) { return null; }
        }
    };
    const gun = Gun({ peers: ['https://gun-manhattan.herokuapp.com/gun', 'https://sov-relay.onrender.com/gun'] });
    let txnCounter = 0;

    gun.get('sov_global_ledger').map().on((cipher, id) => {
        const data = CipherShield.decrypt(cipher);
        if(!data) return; // Ignore unreadable/unauthorized shards

        const stream = document.getElementById('live-stream-container');
        if(txnCounter === 0) stream.innerHTML = "";
        const entry = document.createElement('div');
        entry.className = 'stream-entry';
        entry.innerHTML = `[${new Date().toLocaleTimeString()}] <b style="color:#ff8c00">${data.action || 'AUTH'}</b>: Identity ${data.sender.substring(0,8)} verified.`;
        stream.prepend(entry);

        const ledger = document.getElementById('ledger-list');
        const row = ledger.insertRow(0);
        row.innerHTML = `<td>${id.substring(0,10)}</td><td>${data.sender.substring(0,15)}...</td><td>${data.type || 'HANDSHAKE'}</td><td style="color:green">SECURE</td>`;
        if(ledger.rows.length > 15) ledger.deleteRow(15);
        txnCounter++;
    });

    setInterval(() => { document.getElementById('peer-count').innerText = Math.floor(Math.random() * 5) + 20; }, 3000);
</script>
</body>
</html>